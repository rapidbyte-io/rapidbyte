{
    "manifest_version": "1.0",
    "id": "rapidbyte/dest-postgres",
    "name": "PostgreSQL Destination",
    "version": "0.1.0",
    "description": "Writes data to PostgreSQL using INSERT or COPY",
    "protocol_version": "2",
    "artifact": {
        "entry_point": "dest_postgres.wasm"
    },
    "permissions": {
        "network": {
            "allow_runtime_config_domains": true
        },
        "env": {
            "allowed_vars": ["PGSSLROOTCERT"]
        }
    },
    "roles": {
        "destination": {
            "supported_write_modes": ["append", "replace"],
            "features": ["bulk_load_copy", "bulk_load_copy_binary"]
        }
    },
    "config_schema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "required": ["host", "user", "database"],
        "properties": {
            "host": { "type": "string", "description": "Database hostname" },
            "port": { "type": "integer", "default": 5432 },
            "user": { "type": "string" },
            "password": { "type": "string" },
            "database": { "type": "string" },
            "schema": { "type": "string", "default": "public" },
            "load_method": { "type": "string", "enum": ["insert", "copy"], "default": "copy" }
        }
    }
}
