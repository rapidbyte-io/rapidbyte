version: "1.0"
pipeline: sql_transform_test
source:
  use: source-postgres
  config:
    host: "127.0.0.1"
    port: 5432
    user: "rapidbyte"
    password: "rapidbyte"
    database: "rapidbyte_test"
  streams:
    - name: public.users
      sync_mode: full_refresh
  permissions:
    network:
      allowed_hosts:
        - "127.0.0.1"

transforms:
  - use: transform-sql
    config:
      query: "SELECT id, UPPER(name) AS name FROM input"

destination:
  use: dest-postgres
  config:
    host: "127.0.0.1"
    port: 5432
    user: "rapidbyte"
    password: "rapidbyte"
    database: "rapidbyte_test"
    schema: "raw"
  write_mode: replace
  permissions:
    network:
      allowed_hosts:
        - "127.0.0.1"

state:
  backend: sqlite
